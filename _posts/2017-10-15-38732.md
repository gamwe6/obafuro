---
layout: post
title: SQL serverにて、複数のテーブルを縦方向に連結させたい
date: 2017-10-15 20:35:11
categories: sql sql-server
---
<p>SQLのテーブルについての質問です。<br>
【やりたいこと】<br>
SQL server上で、多数のテーブル（カラム等は同じ）を、全て縦につなげたい<br>
（UNIONを使ってもいいが、たとえばテーブルが100件あると一つ一つ書くのが面倒に）</p>

<p>【詳細】<br>
現在、日々のログデータ(Excel, 100000行/day)を<br>
[20171015]、[20171016]、[20171017]…という名前でExcelシートに保存しており、<br>
それらのシートを一括でSQL serverにインポートしています。</p>

<p>この方法だと、SQL server上ではテーブルがシートの数だけ（つまり日数分）<br>
作成されています。</p>

<p>ここから月毎、年単位での分析をするときに、<br>
一度に読み込めるようそれらのシートをすべて縦に繋げたいのですが</p>

<p>UNION句を使う方法では、シートの数だけUNIONが必要になってしまい、<br>
非常に書くのが難しく(面倒くさく)なってしまい、見栄えもよくありません。</p>

<p>良い方法をご存じの方がいらっしゃいましたら、お願いします。</p>
