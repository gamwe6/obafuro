---
layout: post
title: "ウィンドウ内にマウスカーソルを維持"
date: 2015-03-31 15:59:53
categories: c++ directx win32api
---
<p>C++でゲーム開発を行っております。<br>
マウスカーソルをウィンドウから出さないためにはどのような処理をすればよろしいでしょうか。</p>

<p>例えば Teeworlds や Steam 内の多数のゲームで実装されています。</p>

<p>ゲーム内ではマウスカーソルは別の画像を用いているのでマウスカーソルを消すことは可能です。</p>

<p>マウスカーソルがウィンドウ外に出ている場合 <code>SetCursorPos</code> で内に戻す処理を行っても<br>
やはり 60FPS なので多少出てしまいます。<br>
マウスカーソルを消して、常にアクティブ状態にすれば見かけ上可能ですが、<br>
その場合は</p>

<ol>
<li>現在 <code>ShowCursor</code> によりカーソルを非表示にしておりますが、自 window 外でも消去する方法。</li>
<li>常にアクティブ状態に保つ方法が分かりません。( <code>WM_ACTIVATE</code> 時に <code>SetForegroundWindow</code> や 60FPS で<code>SetForegroundWindow</code> を行いましたが少しちらつきます)</li>
</ol>

<p>カーソルを 60FPS で画面中央に固定し、各フレーム毎に変位を求め、別でマウスカーソルの位置を処理する方法だとまあまあ上手くいきますが、1フレームで画面外まで移動されるとやはり同じこととなってしまいます。</p>

<p>60FPS が遅いなら別スレッドで処理すれば良いのですが、Windows がマウスを処理するクロックサイクル以下にはできないかと思います。</p>

<p>ですので、できれば他の方法で行いたいと考えております。</p>

<p>環境は C++ で行っており、DxLib を使用しておりますが、Window メッセージは処理できる形になっております。</p>
