---
layout: post
title: "IJCAD2018でVBAからC#を呼び出し、図面をAutoCAD2013の形式で保存する"
date: 2018-10-10 02:12:45
categories: .net ijcad
---
<p>IJCAD2018でC#を使用して開発をしております。<br>
現状、メニューをVBAで作成し、ボタンが押下された後の処理をC#で実装しています。<br>
VBAからはC#で用意したコマンドをSendCommandで送っています。</p>

<p>C#側で図面を保存する時にAutoCADの2013形式で保存したいのですが、<br>
.netAPIでは2013を指定して保存する方法がなく、SendCommandを使用するしかありません。</p>

<p>しかし、IJCADではSendCommandを使用するとコマンドの終了を待たず、処理が進んでしまうため<br>
それが原因となり不具合が発生してしまいます。<br>
システム変数CMDACTIVEを取得してコマンドが実行可能状態になってから処理を再開するとゆう<br>
方法を試してみましたが、既にVBAからコマンドでC#を呼び出しているため<br>
常にコマンドが実行状態になってしまい、期待する結果は得られませんでした。</p>

<p>C#のSendCommandでシステム変数CMDACTIVEを監視する以外にコマンドの終了を<br>
待つ方法はありませんでしょうか？</p>
