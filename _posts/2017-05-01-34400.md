---
layout: post
title: "Excelセルの画像化をクリップボードを使用しないで行えないでしょうか？"
date: 2017-05-01 05:49:25
categories: excel vba
---
<p>開発用Excelバージョン Excel2013<br>
※ 特定のExcelバージョンでしか実現できない方法でもかまいません</p>

<p>Excelの指定範囲のセルを画像化するVBAアプリケーションを作成しています。VBAで画像化を行う一般的な方法は、<a href="https://msdn.microsoft.com/ja-jp/library/office/ff193594.aspx" rel="nofollow noreferrer">Range.CopyPicture</a>を使うことだと思いますが、この場合システムのクリップボードにコピーが行われてしまうため、別のアプリケーションがクリップボードを使用していると、データが上書きされてしまいます。</p>

<p>バックグランドで動作することを前提としているため、そもそもシステムのクリップボードを使うことがあまり行儀がよくないと思いますし、最悪でも排他制御は行いたいのですが、これもどのようにすればよいのかわかりません。</p>

<p>Excelプロセス専用のクリップボードを用意する方法であったり、クリップボードを使用しないでCopyPictureと同じような処理を行う方法はないでしょうか？<br>
これらが難しい場合、複数アプリケーション間でクリップボードの排他制御を行う方法があればサンプル等提示いただけると助かります。</p>
