---
layout: post
title: "組織内で「Webアプリケーションとして導入」をした際の認証について"
date: 2019-08-26 11:50:57
categories: google-apps-script oauth
---
<p>【前提】<br>
当方、G Suite Businessを利用しています。<br>
「Webアプリケーションとして導入」については下記の設定です。<br>
・次のユーザーとしてアプリケーションを実行:⇒自分<br>
・アプリケーションにアクセスできるユーザー:⇒組織の全員</p>

<p>【目的】<br>
社内システムにて、スプレッドシートを権限によって操作するにあたり、<br>
実行ユーザとは別に、開発者ユーザで処理をしたく検討しています。</p>

<p>【処理の流れと事象】<br>
１．スプレッドシートに紐づくGAS実行（一般ユーザ）<br>
　↓<br>
２．Webアプリケーションとして導入したGAS（開発者ユーザ）<br>
という流れでロジックを制御したいのですが、<br>
スプレッドシート実行時のUrlFetchApp.fetchでWebアプリケーション側の<br>
doGetを呼び出すにあたり、認証ページへ飛んでしまい実行できない<br>
という事象が発生しています。</p>

<p>【検証と制約】<br>
Googleアカウントでログイン済のブラウザから２の実行はもちろん可能です。<br>
また、セキュリティ上の問題により、G Driveの公開は組織内としており、<br>
アクセス範囲として「全員」は選択できない状況となっています。</p>

<p>【お願いしたい回答】<br>
UrlFetchApp.fetchでWebアプリケーションとして導入したGASを呼び出すにあたり、<br>
事前に認証を通す方法を教えていただけないでしょうか。<br>
目的としてはGAS実行時に実行ユーザと開発ユーザを分けて処理をすることですので、<br>
本件に限らず、別の方法で実現されている方がいらっしゃればアドバイス頂けると助かります。</p>
