---
layout: post
title: "Elasticsearchの使い方について（利用方法やバックアップなどについて）"
date: 2018-11-01 07:56:12
categories: elasticsearch
---
<p>追記<br>
take88さんから指摘がありましたので内容をもっと限定的にしたいと思います。<br>
１、elサーチのデータバックアップはmysqlと同等で安全に不具合や問題なく使えるかどうか<br>
２、全文検索以外の用途で使うのはよくあることか</p>

<p>例<br>
記事のgood数を保存でのelの利用<br>
mysqlのでgood数を保存しユーザーごとにgoodの状態(good済かどうか)を保存しておくとしたら</p>

<pre><code>post_id / count
1 / 123
2 / 12
3 / 22

post_id / voted_user_id / voted_date 
1 / 2 / 2018-11-02 00:00:00
2 / 2 / 2018-11-02 00:00:01
2 / 3 / 2018-11-02 00:00:02
</code></pre>

<p>といった感じになると思いますがこのテーブルにデータの追加、削除、更新、確認を行う場合<br>
Redis等に比べると速度的に遅くなり何千万件とかの大量のデータを扱ったときに問題になってくるのではないかと考えています。<br>
ただ、Redisの場合、永続性の問題でaofに設定した場合通常のredis運用に比べて100倍ほど遅くなるとあり、であればelで同じことをしたらどうなのか？mysqlよりは速度的な問題は解消されRedisと同等のパフォーマンスが出せるのではないか？と考えました。<br>
こういった使い方をelで行うことは問題ない？いい方法？なのでしょうか。</p>

<p>以上、2点についてご教授頂ければと思います。よろしくお願い致します。</p>

<blockquote>
  <p><strong>はじめの質問</strong><br>
  最近、Elasticsearchを触りはじめたのですが これまで全文検索をgroongaやmysqlの全文検索で実装していました。<br>
  データストアとして安全性や使いやすさ管理のしやすさを考えるとmysqlの方がいいのかなと何となく思っていて<br>
  通常のデータは一度mysqlの方に保存していき、そこからElasticsearchに流し込むのがベストなのかと考えています。<br>
  この認識が正しいのかどうか知りたいです。<br>
  Elasticseachだけでも全く問題ないよというのであれば、バックアップや運用などmysqlの場合と比較してどのように変わるのか？<br>
  また、たとえば集計を行うならredisのsorted<br>
  setを利用したりElasticseachのアグリゲーションを利用した方が速いかと思いますが、データの消失は大丈夫なのかなど不安で。<br>
  この運用がベストプラクティスじゃないかと思うよというのがあればご教授頂ければと思います。 よろしくお願い致します。</p>
</blockquote>
