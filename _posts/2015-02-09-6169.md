---
layout: post
title: 一部の Android 端末で、予測変換候補表示部分に EditText が写りこむ
date: 2015-02-09 01:56:45
categories: android
---
<p>Android のソフトウェアキーボードの予測変換に関するバグについて質問です。</p>

<h3>アプリの構成</h3>

<p>画面下にエディットテキスト(EditText) をおいた、 Line や Skype のチャットのようなアプリです。</p>

<h3>再現状況について</h3>

<ol>
<li>EditText をタップし、ソフトウェアキーボードを表示</li>
<li>てきとうな文字を入力し、予測変換を出す</li>
<li>確定や戻るなどで、予測変換のみ閉じる</li>
<li>予測変換の出ていた部分に EditText の表示が移ってしまう（入力などはできない）</li>
<li>キーボードそのものを閉じると、その部分も消える</li>
</ol>

<h3>再現する端末について</h3>

<p>Nexus 系の端末や、 Xperia などで発生しています。 Galaxy シリーズなどでは、発生しないようです。</p>

<p>スクショを添付致します。<br>
スクショの赤枠の部分が該当部分となります。</p>

<p><img src="https://i.stack.imgur.com/KaBokl.png" alt="現象再現スクショ"></p>

<p>上記のバグ？について、解決方法や助言を頂けると幸いです。なにとぞ、よろしくお願い致します。</p>

<p>＝＝＝＝＝＝追記（2015/2/11）=＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝<br>
quesera2様<br>
コメントありがとうございます。階層ビューアーを試してみたのですが、いまいちうまく反応せず、まだできておりません。</p>

<p>小出しになって申し訳ありませんが、以下に簡易的ですが、階層を追記します。</p>

<p><br>
 <br>
    // ここにチャットの内容が入ります。<br>
   //ここにEditTextが入ります。<br>
 <br>
</p>

<p>頂いたコメントを参考に、試してみたことを記載します。</p>

<p>１．ListViewを再描画　×<br>
２．全体のViewを再描画　×<br>
３．ハードウェアアクセラレーターをfalseに設定　→　赤枠の部分が黒くなった。<br>
４．予測変換が消された時にListViewを一瞬GONEに設定　赤枠部分が消えたが、画面のチラつきが酷い。</p>

<p>以上になります。<br>
４の方法で消すことはできたのですが、チラ付きがひどく、納得のいく状態にはなりませんでした。</p>

<p>＝＝＝＝＝（追記２）＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝<br>
user3009331様</p>

<p>情報、ありがとうございます。<br>
こちらでも、ParrentViewにPaddingBottomを入れてみたところ、おかしくなっている部分は消えましたが、不自然に下が空いてしまうため、やはり実用的ではないようです・・・。<br>
キーボード表示と同時に、Paddingを設定してみましたが、二度目の予測変換表示時に、おかしくなってしまいました。<br>
根本的な原因を突き止めないと、どうしようもなさそうですね・・・。<br>
また一歩進めた気がします。ありがとうございます！</p>

<p>引き続き、解決策について、ご教授頂けると幸いです。</p>
