---
layout: post
title: 単一StreamへのFIFOな排他アクセスの方法について
date: 2017-02-27 09:20:03
categories: c# stream audio-streaming
---
<!-- {% raw %} -->
<p>現在、C#にて音楽再生アプリを作成しています。<br>
以下の要件を満たすようなStream（もしくはそれに準じるもの）を探しているのですがいまいち見つけられません。</p>

<p>・単一のStreamの末尾にbyte配列を書き込みながら、同時に先頭から読込できる。</p>

<p>書き込み用スレッドと読み込み用スレッドを作成し、<br>
書き込み用スレッドでは5秒程度に分割された音楽ファイルをweb上からHttpリクエストで取得し、byte配列として順次Streamに書き込んでいく。<br>
一方、ストリーミング再生を実現するため、（上記の音楽ファイルのStreamへの書き込みを行う傍ら）、読込用スレッドで先頭からStream上のbyte配列を読込み、再生する。</p>

<p>このような要件を実現したいのですが、いまいちうまくいきません。<br>
MemoryStreamですとFIFOや排他アクセスが実現できず、<br>
Queueですとどうしても再生時に切れ目が出来てしまいます。</p>

<p>標準ライブラリでは無いとしても、継承して実装できれば構いません。<br>
宜しくお願い致します。</p>
<!-- {% endraw %} -->
