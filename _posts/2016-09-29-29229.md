---
layout: post
title: ".NetFrameworkでのプリンタ切断検知"
date: 2016-09-29 02:51:28
categories: windows visual-studio .net
---
<p>現在アプリからプリンタに出力するアプリがあります<br>
接続切断検知についてなのですが<br>
LocalPrintServerクラスのGetPrintQueueメソッドからプリンタの状態を取得しているのですが<br>
取得した状態のうち<br>
IsOfflineプロパティが常にfalseになってしまいます</p>

<p>USBケーブルを抜き差しすると、デバイスとプリンターのアイコンが<br>
抜いているときはハーフグレーになるのでOSはプリンタが切れたことを検知しているみたいなのですが<br>
プログラム上からは常にオンライン(IsOffline=false)となってしまいます(カバーオープンや紙切れは検知するのですが・・・・)</p>

<p>プリンタの接続状態は他に、どのような方法で検知すればいいのでしょうか</p>

<p>今の環境はWindows7/.NetFramework4.5なのですが、Windows8.1やWindows10でも使用できる方法が知りたいです</p>

<p>業務用のプリンタなので最初はそういう仕様なのかと思いましたが、<br>
デバイスとプリンター上からはちゃんと検知しているので何か標準的な方法が他にあったりするのでしょうか</p>
