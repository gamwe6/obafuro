---
layout: post
title: 有効無効を表現するためのデータベース設計にデファクトスタンダードはありますか？
date: 2015-09-14 03:41:09
categories: database データベース設計
---
<blockquote>
  <p><code>意見やディスカッションを求める質問</code>に該当する場合は、クローズ票を入れていただければ、直ちにクローズ致します。</p>
</blockquote>

<p>例えば、ユーザーの設定により通知のオン・オフを切り替えるシステムを考えます。</p>

<p>データベース設計として2通りを考えました。</p>

<ol>
<li>ステータス列を作成して、オン・オフ表現する</li>
<li>レコードの有無で、オン・オフを表現する</li>
</ol>

<p>具体例として、ユーザー1は通知が有効、ユーザー2は通知が無効、を考えます。</p>

<p>1の例</p>

<pre><code>| user_id | enabled |
|:-------:|:-------:|
| 1       | true    |
| 2       | false   |
</code></pre>

<p>2の例</p>

<pre><code>| user_id |
|:-------:|
| 1       |
</code></pre>

<p>1の場合、メリットとして、下記が考えられます。</p>

<ul>
<li>オフであるということが明確にわかります。</li>
<li>通知をオフにした人は何人？などの集計も簡単です。</li>
</ul>

<p>一方で、デメリットは、量が多いことです。</p>

<ul>
<li>データ量が多い (ユーザー数 x 通知の種類)</li>
</ul>

<p>2の場合、メリットとして、</p>

<ul>
<li>データ量は少ないです。</li>
</ul>

<p>デメリットは、下記を考えました。</p>

<ul>
<li>INSERT / DELETE で更新する(DELETEは遅い)</li>
<li>オフに対する集計ができない (全てからオンを引く、という状態)</li>
<li>オフに対する状態が保持できない (x日にオフになった等)</li>
</ul>

<p>とはいえ決定打となる要素がなく、現状は、ケースバイケースで対応してしまいます。</p>

<p>データベース設計に関するデファクトスタンダード、<br>
または、書籍、積極的に発信をしいるウォッチ推奨のエンジニア、など<br>
ご教授願えれば幸いです。</p>

<h1>参考にしたもの</h1>

<p><a href="http://www.slideshare.net/nippondanji/db-engineerstudyanim">データベース設計徹底指南</a></p>

<blockquote>
  <p>ある物事に対する事実の集合</p>
</blockquote>

<p>「通知を受け取るユーザーの集合」だと考えれば、1?<br>
「ユーザーの通知設定」というデータの集合だと考えれば、2?</p>

<p><a href="http://gihyo.jp/dev/feature/01/database/0001">第1回　データベース設計とは：初めてのデータベース設計｜gihyo.jp … 技術評論社</a></p>

<blockquote>
  <p>概念設計では，データベースによって管理の対象とするものを現実の世界から抽出して概念モデルを作成します。</p>
</blockquote>

<p>管理の対象は、ユーザーごとの通知設定。<br>
レコードで管理するのか、行で管理するのかは、概念モデルの時点では判明しない？</p>
