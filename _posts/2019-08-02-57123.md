---
layout: post
title: Kerasのリカレントネットワークと、通常のネットワークの違いについて
date: 2019-08-02 06:36:27
categories: python keras
---
<!-- {% raw %} -->
<p>KerasでSimpleRNNを用いたネットワークでは、時系列データ [x(0), x(1), ... , x(t)]を与えるのではなく、</p>

<pre><code>[[x(0), x(1), x(2)],
 [x(1), x(2), x(3)],
 [x(2), x(3), x(4)],]
</code></pre>

<p>のように、時刻毎に入力データを用意し、さらに</p>

<pre><code>[[x(0)], [x(1)], [x(2)]],
 [[x(1)], [x(2)], [x(3)]],
 [[x(2)], [x(3)], [x(4)]],]
</code></pre>

<p>のように変形しなければなりませんよね？<br>
学習時だけでなく、予測時にも</p>

<pre><code>[[x(10)], [x(11)], [x(12)]],   # x(13)を予測
 [[x(15)], [x(16)], [x(17)]],  # x(18)を予測
 [[x(100)], [x(101)], [x(102)]],]  # x(103)を予測
</code></pre>

<p>のような、形式で与えなければならないと認識しています<br>
実際、このように与えることで、RNNは正しく値を予測してくれました</p>

<p>しかし、入力データとして、数ステップ前の値を自分で用意するのであれば、そもそもRNNに意味はあるのでしょうか？<br>
上記の内容を<br>
入力データを</p>

<pre><code>[[x(0), x(1), x(2)],
 [x(1), x(2), x(3)],
 [x(2), x(3), x(4)],]
</code></pre>

<p>とする、MLPに置き換えても、うまく推定できました。</p>

<p>KerasのRNNについて勉強する前は、fitやperdictをするたびにネットワークが前回の値を保持してくれて、入力としては現在時刻の値だけ入れればやってくれるのだと思っていました。<br>
Layerとして、SimpleRNNを使う意味はなんなのでしょうか？</p>
<!-- {% endraw %} -->
