---
layout: post
title: GAS データがある最終行取得
date: 2019-03-24 14:15:23
categories: javascript google-apps-script
---
<!-- {% raw %} -->
<p>GASを使ってスプレッドシートのデータがある最終行または最終カラムを取得したいです。<br>
前まではスプレッドシートのデータがある最終行までのデータは下記のコードで取得できていたのですが、シート数が何枚にもなり下記の(変更後)にコードを変更しました。<br>
そしたら <code>var row = sheet.getLastRow();</code> をデバックで見てみたらデータではなくセルの最終行のデータが取得されてしましました。<br>
<a href="http://code-ur-life.blogspot.com/2014/03/google-apps-script-script.html" rel="nofollow noreferrer">http://code-ur-life.blogspot.com/2014/03/google-apps-script-script.html</a> のサイトなどを見てみたのですが私がやりたい、データがある最終行までのデータを取得するやり方がわかりません。</p>

<p>なぜデータを取得したいかというとデータを取得してそのデータをforEachで回したいからです。</p>

<p>初心者なので初歩的な質問または文がおかしいみたいなとこがあるかもしれませんが、分かる方がいたら教えていただきたいです。<br>
よろしくお願いします。</p>

<pre><code>var sheet = SpreadsheetApp.getActiveSheet();
var row = sheet.getLastRow();
</code></pre>

<p>変更後</p>

<pre><code>var spreadsheet = SpreadsheetApp.openById(IDが入っています);
var sheet = spreadsheet.getSheetByName('シート２').activate();
var row = sheet.getLastRow();
</code></pre>
<!-- {% endraw %} -->
