---
layout: post
title: ラズベリーパイのデフォルトの設定でサーバーを公開することは危険？ その被害と対策とは
date: 2016-03-11 20:12:58
categories: linux raspberry-pi raspbian
---
<p>小型コンピューターとして有名な<a href="http://www.amazon.co.jp/Raspberry-Pi-Model-B-Plus/dp/B00LT4BOK6" rel="nofollow">ラズベリーパイ</a>を購入しました。<br>
OSは公式サイトからダウンロードした<a href="https://www.raspberrypi.org/downloads/noobs/" rel="nofollow">NOOBS</a>を利用して<a href="https://www.raspberrypi.org/downloads/raspbian/" rel="nofollow">Raspbian</a>をインストールしました。</p>

<p>ところでなんですが、このRaspbianというOSはデフォルトの設定でSSH接続が許可されており、ユーザー名は<code>pi</code>、パスワードは<code>raspberry</code>となっているため、ローカルネットワークに有線LANで接続することですぐにSSH接続が可能となります。そのうえユーザー<code>pi</code> はsudo実行権限もあります。</p>

<p>このラズベリーパイをユーザー名やパスワードを変更しないままルーターのグローバルIPアドレスを調べて、SSHポート開放も行い、インターネットから接続できるようにして便利に使用としたところ、誰にもグローバルIPアドレスは伝えていないにもかかわらず公開から３日後にラズベリーパイが何者かに乗っ取られ大量のメールが送信されてプロバイダからインターネット接続停止の措置を受けていまいました。</p>

<p>プロバイダ側からラズベリーパイからの送信が確認ができたメールは<strong>１０分間に１２万通</strong>とのことで、この１２万通は宛先不明で返送されてきたものなので、プロバイダからは<strong>実際には１０分間で１００万件</strong>以上のメールが送信された可能性があると説明を受けました。</p>

<p>そこで質問です</p>

<p><strong>質問１</strong><br>
ラズベリーパイをデフォルト設定で公開することは危険でしょうか？</p>

<p><strong>質問２</strong><br>
攻撃者はどのようにして私だけが知っているグローバルIPアドレスを調べあげたのでしょうか？</p>

<p><strong>質問３</strong><br>
このようにサーバーの乗っ取り被害に合わないためにどのような対策や認証方式を行うべきでしょうか？</p>

<p><strong>質問４</strong><br>
<code>$ history</code>に侵入者がコマンドを実行した形跡がなかったのですがどのようにしてスクリプトやコマンドを実行したのでしょうか？</p>

<p>いま思ってみても公開されているユーザー名とパスワードをそのまま使うのはあまりに無防備だったのかなと思いますが、ほかの方の役に立てればと思い共有させてもらいました。</p>

<p>なお、被害にあった翌日、プロバイダのセキュリティ部門から自宅に電話があり、乗っとり被害にあった事情を話すと自宅でサーバーの公開はしないようにしてくださいと念を押されたあとインターネットの停止措置は解除されました。</p>
