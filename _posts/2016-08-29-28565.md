---
layout: post
title: "IE操作中に実行されたメッセージボックス(ポップアップ)の操作方法"
date: 2016-08-29 15:35:00
categories: powershell
---
<p>PowerShellでIEを操作し自動化スクリプトを作成しています。<br>
例えばIEを起動、指定ページにアクセスしログイン、その他必要な処理などは実現出来ました。</p>

<p>しかし、問題がありその必要な処理の中に「保存ボタン」を押下する処理があるのですが、<br>
それを行うと「保存を行いますか？」とメッセージボックスが出現し、「OK」を押下しないと次の処理が動かない仕組みになっています。<br>
これをなんとかして自動で「OK」を選択するようにしたいのですが、どうすれば良いのでしょうか。</p>

<p>ComObjectで下記の用に情報を取得しています。</p>

<p>$shell = New-Object -ComObject Shell.Application</p>

<p>これを利用してIEを指定する事はできているのですが、<br>
メッセージボックスの情報は取得出来ていないようです。</p>

<p>■試行内容<br>
最初はIDがわかればgetElementByIDで指定しようと思ったのですが、<br>
上記の通り根本的な情報が取得出来ないので不可。<br>
また、座標クリックを行おうと思いましたがPowerShellの方法がいまいち不明で断念。<br>
仮に上記2つが出来たとしても、メッセージボックスが表示されている状態では、<br>
実行中と判断され(busy = True)次のコマンドが実行されません。自分の知識ではお手上げです。</p>

<p>指定のサイト自身に手を加える事は出来ません。<br>
また、UWSCなどフリーソフトを使用することも出来ません。<br>
どうぞよろしくお願いいたします。</p>
