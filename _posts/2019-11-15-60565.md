---
layout: post
title: Microsoft Officeなしでhtmlをxls形式に変換するサンプル
date: 2019-11-15 17:00:08
categories: excel
---
<!-- {% raw %} -->
<p>.NET Framework3.5を使用しています。</p>

<p>対象のプログラムはMicrosoft. Interop. Excel .dllを用いてHtml形式ファイルをXls形式ファイルに変換しているのですが、対象の顧客環境にExcelがインストールされているにも関わらず、制限がかけられているのか、dllからExcelを呼び出せない状態が続いています。<br>
Excelがインストールされていないかのような動作をします。</p>

<p>現状、上記の調査が難航しているため、上記dllを用いて動作環境にインストールされているExcelの機能を使わずに、Htmlをxlsに変換する方法を調査しているのですが、サンプル等ご存じないでしょうか。<br>
以下の様なことをプログラムを使わずにExcelを使用すれば可能なのですが、これをNPOI等のサードパーティ製のプログラムを使って、Excelがインストールされていなくてもxlsを出力できる状態にしたいのです。htmlが生成できるまでは対象顧客環境でも検証できています。</p>

<p>　1)htmlの拡張子をxlsに変更<br>
　2)ダブルクリックして警告を無視してExcelで開く<br>
　3)シート名をSheet1に変更<br>
　4)シートの特定の列にドロップダウンリストで特定の値のリストを埋め込み<br>
　5)名前を付けて保存して、xlsとして保存</p>

<p>サンプルコード等あれば教えていただけないでしょうか。NPOIでなくても構いません。</p>
<!-- {% endraw %} -->
