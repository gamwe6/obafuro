---
layout: post
title: "外部システムからAPIを使ってGoogleドライブのファイルを検索したい"
date: 2019-06-14 06:36:44
categories: google-drive-sdk
---
<h1>目的</h1>

<p>・外部システムとはFess（全文検索システム）<br>
・Googleドライブ APIは 利用許可済み<br>
・Fess から Googleドライブ API を介して Googleドライブのファイルをクロールしたい</p>

<h1>状況</h1>

<p>・googleドライブのドメインは管理コンソールの共有オプションにて「オフ」を設定<br>
・検索用のユーザーを作成、管理コンソールの共有オプションにて「オン」を設定<br>
・検索用のユーザーにてサービスアカウントキーを作成<br>
・検索ユーザー以外のファイルにはサービスアカウントのclient_emailを共有設定で追加していく<br>
・現状、クロール（ファイルを探すこと）ができたのは検索ユーザーのファイルのみ</p>

<h1>問題点</h1>

<p>１．検索ユーザー以外のファイルに「管理者のポリシーにより、一部のユーザーは利用できません」というエラーは表示される<br>
２．サービスアカウントキーを使ってドメイン内のGoogleドライブをアクセスしているので、アクセスできてない理由がわからない</p>
