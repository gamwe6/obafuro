---
layout: post
title: SQL抽出結果から配列の配列を作るには？
date: 2018-10-07 00:37:18
categories: c#
---
<p>※環境ASP.NET MVC4(C#)</p>

<p>お世話になります。</p>

<p>目的→knockoutjsで3連動のドロップダウンリストを実現する</p>

<p>公式サンプルを参考に3連動用(親・子・孫)のモックデータを作り<br>
実現できることは確認済です。</p>

<p>しかし3連動用のデータは本来はDBから抽出します。<br>
今はIListで取得しています。<br>
問題なのは、SQL抽出結果をそのモックデータと同じ構造にすることです(←両者後述します)。<br>
いろんなサイトで調べましたが、難儀し結果わからず、質問した次第です。</p>

<p>SQL抽出結果からモックデータと同じ構造の配列を作るにはどうしたらよいのでしょうか？<br>
親の配列の中に子の配列があり、子の中にコードと名称の配列がある(？)イメージです。<br>
この辺不得意分野で、分かりやすい説明も頂けたら助かります。<br>
そして非常に急いでおります(汗)<br>
どなたかご教授お願い致します。</p>

<p>以下SQL抽出内容とモックデータ構造です。<br>
(値は例として書き換えています。)</p>

<p><code>&lt;SQL抽出内容&gt;</code></p>

```
親      子   孫コード    孫名称
2019, 部門１, 001,    部門１のサブ名称
2019, 部門１, 002,    部門１のサブ名称2
2019, 部門２, 002,    部門２のサブ名称
2018, 部門１, 001,    部門１のサブ名称
2018, 部門Ａ, 001,    部門Ａのサブ名称
2018, 部門Ａ, 002,    部門Ａのサブ名称2
```

<p><code>&lt;モックデータ&gt;</code></p>

```
var moq = 
[
    {
        "親": 
        [
            {
                 "子": 
                 [
                    {
                         "孫コード": "001",
                         "孫名称"  : "部門１のサブ名称"
                    },
                    {
                         "孫コード": "002",
                         "孫名称"  : "部門１のサブ名称2"
                    }
                 ],
                 "子値": "部門１"
             },
            {
                "子": 
                [
                    {
                        "孫コード": "001", 
                        "孫名称": "部門２のサブ名称" 
                    }
                ],
                "子値": "部門２"
            }
         ],
        "親値": "2019"
    },
    {
        "親": 
        [
            {
                 "子": 
                 [
                    {
                         "孫コード": "001",
                         "孫名称"  : "部門１のサブ名称"
                    }
                 ],
                 "子値": "部門１"
             },
            {
                "子": 
                [
                    {
                        "孫コード": "001", 
                        "孫名称": "部門Ｂのサブ名称" 
                    },
                    {
                        "孫コード": "002", 
                        "孫名称": "部門Ｂのサブ名称" 
                    }                    
                ],
                "子値": "部門Ｂ"
            }
         ],
        "親値": "2018"
    }
];
```
