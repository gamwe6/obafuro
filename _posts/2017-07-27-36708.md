---
layout: post
title: さくらサーバーでメールのみ利用時に独自ドメインでメールサーバーへ接続できない
date: 2017-07-27 03:46:02
categories: dns mail
---
<p>お世話になります。<br>
現在、さくらサーバーで下記の挙動の試験をしています。<br>
Aレコードを外部サーバーに向け、MXレコードをさくらサーバーへ向けると、<br>
さくらで与えられる初期ドメインではメールを見ることができるのですが、独自ドメインではメールが見られなくなる原因がわからない状態です。</p>

<blockquote>
  <p>さくらのドメイン: example.com<br>
  WEB用サーバー: 192.168.0.0（仮）<br>
  さくらのサーバー（メール用）: 192.168.0.1（仮） / 初期ドメイン: www.0000.sakura.ne.jp</p>
</blockquote>

<p>初期のexample.comをすべてさくらサーバーへ向けている状態では、メールサーバーを「example.com」としていても、「www.0000.sakura.ne.jp」としてもメールサーバーへ接続できますが、下記のような設定でAレコードを外部サーバーへ向けると、example.comではメールサーバーにアクセスできなくなります。</p>

<pre><code>@ IN NS ns1.dns.ne.jp
@ IN NS ns2.dns.ne.jp
@ IN A 192.168.0.0
@ IN MX 10 mail
www IN CNAME @
mail IN A 192.168.0.1
ftp IN CNAME @
</code></pre>

<p>運用上は初期ドメインで設定すれば良いので問題ないですが、仕組みや独自ドメインでもメールサーバーへアクセスする方法があれば知りたいです。<br>
よろしくお願いいたします。</p>

<p>--- 追記 ---<br>
example.comではメールサーバーにアクセスできなくなります。についてですが、<br>
Macの標準メールクライアントを利用して、メールアカウントの設定ができなくなります。</p>

<p>試験的にfirst@example.comとsecond@example.comを作成し、<br>
Macの標準メールクライアントで、<br>
first@example.comでは、メールサーバーを「example.com」、<br>
second@example.comでは、メールサーバーを「www.0000.sakura.ne.jp」<br>
と設定した状態で、DNSを変更しています。</p>

<p>さくらドメインからさくらサーバーへの初期設定では、first@、second@ともにメール受信ができていますが、<br>
DNSを上記のものに変更すると、first@ではアカウントエラーになりメールサーバーへ接続ができなくなります。（さくらのオンラインWEBメーラーではメールが確認できます）</p>

<p>メールクライアントとメールサーバーとの接続の確立する際に、Aレコードを参照するために接続ができない？と予想していますが、そうした場合WEBサーバーとメールサーバーを同じドメインで分ける方法が思いつきませんでした。</p>

<p>よろしくお願いいたします。</p>
