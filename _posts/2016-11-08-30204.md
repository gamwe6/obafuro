---
layout: post
title: サーバ上の特定ディレクトリ以下の最新1ファイルをコピーするには?
date: 2016-11-08 06:18:23
categories: shellscript freebsd
---
<!-- {% raw %} -->
<p>安物のネットワークカメラを買いました。ftp経由で転送されてくるのですが、<br>
設定範囲が少なくて、妙案を探しています。(dbpower c300e、アマゾンで賛否両論あり)</p>

<p>/2016-11-08/Capture/13_57_20_200.jpg<br>
/2016-11-08/Capture/13_59_20_319.jpg<br>
/2016-11-08/Capture/14_02_20_498.jpg</p>

<p>上述のような要領で転送されてくるのですが、httpdで公開したいので、以下のような、<br>
いつでも同じパスでアクセスできるようにしたいです。サーバ側はfreebsd、<br>
tcsh等でして、crontabも使えるものの、スクリプトの書き方が分かりません。</p>

<p>/cam1.jpg</p>

<p>findで最新日時のjpgを探し、mvで公開ディレクトリへ名前指定でコピーしたあと、<br>
カメラから転送されて、無限に増え続けるファイルを片付けるため、<br>
日付付きのディレクトリを一括削除といった流れになるかなと<br>
思うのですが、camera.shのようなスクリプトにまとめる際、<br>
中身はどんなものが良いでしょうか?</p>

<p>find /home/camera-user/ -type f -name "<em>.jpg" | xargs -J % mv ...<br>
mv -f /home/camera-user/</em></p>

<p>xargsでつなげて、freebsdでは、jオプションがあるのはわかったものの、<br>
mvの書き方がはっきりしません。日付の新しいものをsortするには、<br>
さらにパイプする必要がありそうです。ヒット順は、最後が最新ファイルに<br>
なるので、最後1ファイルを移動するだけでも良いような・・・。</p>

<p>mv % /home/www/public_html/cam1.jpg</p>
<!-- {% endraw %} -->
