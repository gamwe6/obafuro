---
layout: post
title: 暗号輸出規制の影響を受ける公開鍵で署名されているのに、一時的なRSA鍵は何故検証できたのか
date: 2016-09-24 04:15:31
categories: security ssl openssl
---
<!-- {% raw %} -->
<p>FREAK攻撃で鍵をダウングレードさせる部分がいまいちわかりません。<br>
ダウングレードさせるのは公開鍵のようですが、</p>

<p><strong>Q1.</strong> 公開鍵には認証局等の署名が必要なので、あらかじめ脆弱な公開鍵を用意しているサーバー限定の攻撃なのか？</p>

<p>と思いましたが、「<a href="http://d.hatena.ne.jp/jovi0608/20150304/1425461359" rel="nofollow">華麗なる因数分解:FREAK攻撃の仕組み</a>」によると、</p>

<p><strong>A1.</strong> サーバーが一時的に脆弱な公開鍵を作成する機能への攻撃</p>

<p>のようで。しかし、ここでまた疑問なのが、</p>

<p><strong>Q2.</strong> 一時的な公開鍵をクライアントはどうやって認証するのか？</p>

<p>ということです。<br>
上記の「<a href="http://d.hatena.ne.jp/jovi0608/20150304/1425461359" rel="nofollow">華麗なる因数分解:FREAK攻撃の仕組み</a>」を見ると、サーバーはサーバーの（脆弱でない）公開鍵で署名して送るようなことが書いてあるのですが、それだけではオレオレ証明書なのでクライアントは受け入れないと思うのです。</p>

<p><strong>A2（推測）.</strong> サーバーは脆弱でない公開鍵と脆弱な公開鍵の両方を送って、クライアントは2段階で検証する</p>

<p>のでしょうか？<br>
そうすると、さらに</p>

<p><strong>Q3.</strong> 輸出規制で脆弱でない鍵を扱えないようにされていたのに、どうやって脆弱でない公開鍵を使って脆弱な鍵を検証するのか？</p>

<p>という疑問が出てきます。</p>

<p><strong>A3（推測）.</strong> 規制されていたのは暗号用の鍵で、署名用の鍵は規制されていなかった</p>

<p>のでしょうか？</p>
<!-- {% endraw %} -->
