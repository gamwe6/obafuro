---
layout: post
title: Accessのマクロからftpアップロードのbatファイル実行について
date: 2019-06-10 05:10:18
categories: batch-file ms-access ftp
---
<!-- {% raw %} -->
<p>Accessマクロの「アプリケーションの実行」でftpへデータをアップロードするbatファイルを実行しようとしてますがうまくいきません。<br>
直接batファイルを実行するとうまくいきますが、アプリケーションの実行でbatファイル実行するとうまくいかない状況です。<br>
流れとしては以下の通りになります。</p>

<ol>
<li>ftpへファイルをアップロードするbatファイルを作成。</li>
<li>1.のbatファイルを実行し、ftpへデータがアップロードがされた事を確認。</li>
<li>1.のbatファイルを今度はAccessマクロの「アプリケーションの実行」で実行。</li>
<li>一瞬コマンドプロンプトの画面が表示されるもすぐに消え、マクロが終了。ftpへファイルがアップロードされていない。</li>
</ol>

<p>現象や解決策に心当たり有ればアドバイス頂いてもよろしいでしょうか。<br>
なお、batファイルの中身はftpにアクセスしてdelでファイルを削除した後にputでファイルを保存するだけのものです。</p>

<p>batファイルの内容</p>

<pre><code>open 【ftpのアドレス】
【ftpのID】
【ftpのパス】
bin
prompt

cd jousen

del 【削除するファイル名】
put C:\【アップロードするファイル名】

bye
</code></pre>

<p>実行しようとしたbatファイルの内容は上記の通りです。<br>
Accessからではなく直で実行すると、上記に記載された内容がコマンドプロンプトに表示されてアップロードが完了しますが、<br>
Accessの「アプリケーションの実行」から行うと画像のように<br>
一瞬だけコマンドプロンプト出て消えてしまいます。</p>

<p><a href="https://i.stack.imgur.com/0DGfz.jpg" rel="nofollow noreferrer"><img src="https://i.stack.imgur.com/0DGfz.jpg" alt="一瞬だけコマンドプロンプトが出てきているところのスクリーンショットです。"></a></p>

<p>batの最後のbyeをカットしても結果は同じなので、batファイルの内容見に行く前になんらかのエラーで終了している気もしますが、それがどんなエラーか見当つかずの状態です。。。</p>

<p>＞sayuriさん<br>
正確な情報提示できておらずすいません。</p>

<p>比較対象の直接実行したファイルですが、「ftpcopy_面談.bat」というファイルを実行（ダブルクリック）します。<br>
中身は以下の通りです。<br>
　ftp -s:ftp_bat.txt</p>

<p>で、ftp_bat.txtの中身が上の方で記載したソースになります。<br>
ftpcopy_面談.batもftp_bat.txtもAccessファイルも全て同じフォルダ（ローカル端末上）に保存しております。</p>

<p>＞kunifさん<br>
アドバイス頂きありがとうございます。<br>
リンク先を参考に、作業フォルダや各種パスの環境も見直してみます。</p>
<!-- {% endraw %} -->
