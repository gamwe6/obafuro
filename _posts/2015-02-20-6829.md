---
layout: post
title: VBAで<開く>ダイアログボックスから選択したファイルのパスを取得するには
date: 2015-02-20 07:19:15
categories: macos vba excel
---
<!-- {% raw %} -->
<p>VBAで&lt;開く>ダイアログボックスから選択したファイルのパスを取得する方法についての質問です。</p>

<p>VBAで&lt;開く>ダイアログボックスからファイルを選択は、下記のように実現しました。</p>

<pre><code> strFileName = MacScript("Choose File")
</code></pre>

<p>ファイルパスを取得しようとしたのですが、構文エラーとなり、パスが取得できません。</p>

<pre><code> MsgBox strFileName
 intFF = FreeFile
 Open strFileName For Input As #intFF　　←ここでエラー
</code></pre>

<p>strFileNameをウォッチ式で確認すると、下記のようになりました。</p>

<p><img src="https://i.stack.imgur.com/WqaUW.png" alt="strFileName"></p>
<!-- {% endraw %} -->
