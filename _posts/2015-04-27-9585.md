---
layout: post
title: "アクセス数をもとに人気の記事を取得するには"
date: 2015-04-27 04:56:48
categories: ruby-on-rails
---
<p>勉強のため<code>rails</code>+<code>mysql</code>でブログを作っています。<br>
人気の記事一覧というものを表示したいのですが、設計についてアドバイスください。</p>

<h2>機能</h2>

<p>ログを元に</p>

<ul>
<li>日毎</li>
<li>週ごと</li>
<li>月ごと</li>
<li>年ごと</li>
<li>トータル</li>
</ul>

<p>の人気記事をランキング化して取得</p>

<h2>ログの取り方</h2>

<p>アクセスがあるたびにログ用のテーブルに保存</p>

<p>= 気になること・わからないこと =</p>

<p>単純にアクセスがあるたびに記録してしまうと、同じユーザがリロードするだけで人気記事になってしまうので、対策をとりたい。</p>

<h2>ログの保存の仕方</h2>

<p>ログ用のテーブルを作って、アクセスログとして記録。</p>

<p>= 気になること・わからないこと =</p>

<p>どの程度の規模まで耐えられるか。<br>
1アクセスごとに1データ挿入されるので、肥大化した際の影響がきになる。</p>

<p>もっと適した方法はないか。</p>

<h2>集計の仕方</h2>

<p>上記のログを元に、指定した期間のログの中でもっともログの多かった記事を計算。</p>

<p>= 気になること・わからないこと =</p>

<p>過去のランキングは再計算する必要がないので、計算結果を記録するべきか。<br>
その際に気をつけることはあるか。</p>

<h2>ログ用のテーブル設計</h2>

<ul>
<li>id</li>
<li>post_id</li>
<li>created_at</li>
</ul>

<hr>

<p>以上です。<br>
未熟な部分があると思いますが、アドバイスいただけないでしょうか。</p>
