---
layout: post
title: 異なるshapeのndarrayを，新しい軸を追加した状態で連結したい
date: 2019-04-23 05:57:00
categories: python numpy
---
<p>異なるshapeのndarrayを，新しい軸を追加した状態で連結するにはどうすればよいでしょうか？</p>

<p>例えば，2つの異なるshape(列数は等しい)の2次元配列</p>

<pre class="lang-py prettyprint-override"><code>a = array([[1,1,1,1],
           [1,1,1,1],
           [1,1,1,1]])

b = array([[2,2,2,2],
           [2,2,2,2]])
</code></pre>

<p>を縦方向に連結して，</p>

<pre class="lang-py prettyprint-override"><code>array([[[1,1,1,1],
        [1,1,1,1],
        [1,1,1,1]],
       [[2,2,2,2],
        [2,2,2,2]]])
</code></pre>

<p>というような<strong>3次元の</strong>ndarray配列を作りたいです．<br>
np.vstackで連結すると，新しい軸が追加されないため連結したものも2次元配列になってしまいます．</p>

<p>具体的には，クラス分類用のデータセットとして画像データをndarray形式で読み込んだとき，256次元（ここはそろっている）*?(ここはクラスごとに異なる)のようになっている各クラスの配列を1つのデータとしてまとめたい（しかしクラスごとにインデックスでアクセスしやすいように3次元配列になっている）というようなことを実現したいです．</p>

<p>よろしくお願いします．</p>
