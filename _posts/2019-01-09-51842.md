---
layout: post
title: pythonでメールファイルから本文の指定部分のみを抽出したい
date: 2019-01-09 10:31:30
categories: python python3 正規表現
---
<p>お世話になります。<br>
このように過去に自分が送信したメールの返事で、<br>
自分の書いた文も書いてあるメールファイルがあり、</p>

<pre><code>≪^------------------　××様へ------------------------    
〇月〇日の詳細：
［場所］△△ホール
［持ち物］特になし
 備考
  当日は公共機関をご利用ください。
 ---------------------------------------------------^≫
是非お越しください




-----Original Message-----
From:〇×
Sent: Mondey
To: ☆×
Subject: 日程について

こんにちは
下記のような形で日程を教えてください
≪^------------------　〇〇へ------------------------
 〇月〇日の詳細：
［場所］××ホール
［持ち物］特になし
 備考
  〇〇〇〇〇〇〇〇〇〇
 ---------------------------------------------------^≫
</code></pre>

<p>一番上の「××様へ」の中身である</p>

<blockquote>
  <p>△△ホール<br>
  特になし<br>
  当日は公共機関をご利用ください。</p>
</blockquote>

<p>のみをコマンドプロンプト上に出力させたいと思い、他の方が過去に質問された内容や、<br>
自分が正規表現について質問した際に頂いた答えをもとにこのように書いてみたのですが、</p>

<pre><code>import ExtractMsg
import re
from glob import glob
import sys
args = sys.argv

for filename in glob(r"{}/*.msg".format(args[1])):
    msg = ExtractMsg.Message(filename)
    msg_message = msg.body
    m = re.search('(.*)(^≪^.*-)(.*)(^-.*^≫)(.*)', msg_message, flags 
(re.DOTALL | re.MULTILINE))
    if m :
        x = re.sub('\［.*\］', "", m.group())
        print(x)
    else:
        pass
</code></pre>

<p>何も出力されず、困っている状態です。下の</p>

<p>　「〇月〇日の詳細：<br>
［場所］××ホール<br>
［持ち物］特になし<br>
 備考<br>
  〇〇〇〇〇〇〇〇〇〇<br>
がメール内に書いてある場合にそれを出力しない」</p>

<p>というコーディングができればよいなと思ったのですが、<br>
いまいちどうやればよいかわかりません。<br>
ご教授頂ければ幸いです。</p>
