---
layout: post
title: "マクロ実行時に表示されるダイアログについて"
date: 2016-01-12 01:14:02
categories: excel vba
---
<p>Excel VBAについての質問になります。<br>
作成したマクロを実行した際に、「ダウンロード中」、「保存中」というダイアログが表示され、、キャンセルボタンを押下しないと処理が進みません。（添付画像参照）</p>

<p>以下の二点について、教えていただきたいです。<br>
・「ダウンロード中」、「保存中」ダイアログが表示される原因について（ソースに記載していない）<br>
・キャンセルボタンを押下しないと処理がすすめない原因について</p>

<p>作成したマクロの処理、実行環境につきまして以下になります。<br>
＜作成したマクロの処理内容＞<br>
0. 比較させたいファイルを環境設定シートに記載。<br>
1. 比較元ファイル、比較新規ファイルという2つのファイルを読み込みます。<br>
2. 読み込んだファイルの値を確認し、特定の値をコピー<br>
3. 新しいブックに貼り付け。<br>
4. 新しいブックを保存して終了。<br>
5. 0で設定したファイルをすべて処理するまで1～4を繰り返します。</p>

<p>*比較元、比較新規ファイルはネットワークドライブ上に配置しています。<br>
 また、保存先もネットワークドライブに保存するように指定しています。</p>

<p>＜環境情報＞<br>
OS:Windows7 32bit<br>
メモリ：4G<br>
ソフト: Excel2013 32bit</p>

<p>ダイアログ表示の原因につきまして、<br>
比較元ファイル、比較新規ファイルをネットワークドライブ上に配置しているため、<br>
「ダウンロード中」ダイアログが表示されてしまいます。<br>
しかし、何度かマクロを実行したところ「ダウンロード中」ダイアログが表示されないこともあります。<br>
「保存中」ダイアログも同様にネットワークドライブに比較結果ファイルを保存しているため、表示されます。<br>
何度かマクロを実行したところ「保存中」ダイアログが表示されないこともあります。</p>

<p>添付ファイル「ダウンロード中」ダイアログ<br>
<a href="https://i.stack.imgur.com/FBpro.png" rel="nofollow noreferrer"><img src="https://i.stack.imgur.com/FBpro.png" alt="画像の説明をここに入力"></a></p>

<p>添付ファイル「保存中」ダイアログ<br>
<a href="https://i.stack.imgur.com/kS493.png" rel="nofollow noreferrer"><img src="https://i.stack.imgur.com/kS493.png" alt="画像の説明をここに入力"></a></p>

<p>長文となって申し訳ありません。<br>
以上です。<br>
よろしくお願いします。</p>
