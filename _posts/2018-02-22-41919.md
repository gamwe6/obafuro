---
layout: post
title: Googleフォームから回答した数字の文頭数字0を、スプレッドシートに表示させる方法を教えてください。
date: 2018-02-22 07:53:54
categories: google-apps-script
---
<p>Googleフォームから数値を回答すると、文頭の0が消えた状態でスプレッドシートに格納されてしまいます。<br>
文頭に0が残った形でスプレッドシートに格納する方法はございませんでしょうか？</p>

<p><strong>▼試したこと</strong><br>
・最新の回答が格納される行の上下に1行ずつ余計な行を追加し、どちらも書式を「書式なしテキスト」にするが、回答は数値のままで文頭の0は消えてしまう。<br>
・フォームのスクリプトエディタに以下のようなスクリプトを記入してみるも、文頭0が消えたあとに書式なしテキスト化されてしまう。</p>

<pre class="lang-js prettyprint-override"><code>var ss = SpreadsheetApp.openById("xxxxxxxxxx");
var sh = ss.getSheetByName("回答");

function setFormat() {

    // テキストにしたい列がC列
    sh.getRange(2,3,sh.getMaxRows(),1).setNumberFormat('@');

}
</code></pre>

<p><strong>▼前提</strong><br>
・フォームから送ってほしい数値の桁数は決まっていません（数値の桁数が決まっていたら、上記スクリプトの'@'を'00000000000'などとすればよいのですが、、）<br>
・値がわかればいいので、格納されるデータの書式にこだわりはありません。また、特定の文字を文頭に付加した状態で格納できるようにしていただいても構いません。　例：Googleフォームに「0012AB」と回答すると、文頭に#のついた「#0012AB」がスプレッドシートに格納されてもOK。</p>

<p>以上となります。お力になっていただけますと幸いです。<br>
宜しくお願い致します。</p>
