---
layout: post
title: HTTP 1.1でChunked transfer encodingを拒否する方法
date: 2017-08-27 14:01:09
categories: http
---
<!-- {% raw %} -->
<p>とある組み込みマイコン向けのHTTPライブラリで難儀しています。<br>
ライブラリにgetという関数があり、これを実行すると指定したURLにHTTP 1.1でGETを発行して、応答の本文を文字列として返してくるのですが、<br>
サーバーがChunked transfer encodingで応答すると（即ち、応答ヘッダに Transfer-Encoding: Chunked が含まれた状態）、これをデコードせずに生の文字列を返してしまうのです。</p>

<p>応答ヘッダを取得することはできないので、プログラム側でチャンクをデコードすることはできません。（チャンク化されているかどうかを一意に判別できないため）<br>
また、TCPやHTTPを含めた一切の通信処理は、完全に独立したMCU内で処理されるため、自分でsocketを使ってHTTPを実装することもできません。「</p>

<p>但し、get関数の引数として、要求ヘッダに１行だけ任意のヘッダを追加できる機能があるので、これを利用して、サーバーに、チャンク化しないように要求できないかと考えているのですが・・・<br>
何か方法はないでしょうか？</p>
<!-- {% endraw %} -->
