---
layout: post
title: "Android Activity起動を阻止する"
date: 2015-09-03 06:20:31
categories: android
---
<p>Activityを起動するかしないかフィルタリングしたいです。<br>
onCreateでfinishするのもダメで、それより前にActivityの起動を阻止したいです。</p>

<p>一瞬で終了ではなく、そもそもActivityの開始自体を事前にフィルタリングして<br>
状況に応じて阻止したいです。</p>

<p>なんとなく　Application　でできるかなとも思いましたが無理でした。<br>
なにか方法はありませんか？</p>

<p>実際やりたいことは、特定のスキームを無効化したいので、intent filterで横取りしたいのですが、とにかく一瞬足りともActivityを起動したくありません。<br>
スタックが入れ替わってしまってcurrentのアクティビティが背後に入ってしまうからです。</p>

<p>なのでServiceでintent filterでスキームを受け取ろうと思いましたが、<br>
スキームはActivityしか受け取れないようです。</p>

<p>なので、マニフェストではActivityでスキームを受け取るように書いておいて、<br>
実際はそのアクティビティがコールされる前に阻止できればと思いました。</p>

<p>なんかゴチャゴチャなりましてすいません…</p>

<p>追記<br>
もう必要なくなったのですがなぜこのようなことを実現したいかというと、<br>
UFJのアプリ知ってますか？<br>
今は改善されましたが長い間以下のようなうざい事をしてくれたのでUFJアプリからユーザーのご機嫌を維持するアプリを作ろうと思ってました。</p>

<p>UFJアプリが行っていた事<br>
・開発者モードがONかUSBデバッグがONになっているときとにかくUSBを接続すると<br>
勝手にブラウザを表示して警告を表示する。<br>
（どんなときでもUSBをつなぐ度に勝手にブラウザを表示するのでとにかく迷惑）<br>
この動作をブロックしたかったです。</p>

<p>そのため、UFJが発行するブラウザ起動インテントをオーバーライドというか、吸収するため、<br>
そのURIを自分のアクティビティが横取りします。<br>
しかし、仕組み上、今度は必ず自分のアクティビティが起動してしまいます。<br>
自分のアクティビティを即終了してもユーザーが起動していたアプリはバックグラウンドに移動し、ホームに戻ってしまいます。<br>
なので阻止出来てもユーザーのアプリが中断されるという問題は解決できませんでした。</p>

<p>サービスでインテントを吸収できればよかったのですが、この手のインテントはアクティビティしか吸収できなかったのです。</p>
