---
layout: post
title: Goのhttptestにおいてhandlerに値を渡したい
date: 2016-02-01 08:17:09
categories: go テスト
---
<!-- {% raw %} -->
<p>golangで下記のようなhttpのテストを書いているのですが、httptestにおいてhandlerにRESTのurl（<code>/item/{item_id}</code>)に埋め込んだ値(<code>item_id</code>)を渡すにはどうしたらいいですか？</p>

テストコード

<pre><code>func TestHandler(t *testing.T) {
    handler := func(w http.ResponseWriter, r *http.Request) {
        vars := mux.Vars(r)
        itemID := vars["item_id"]
        fmt.Println("itemID: ", itemID)
    }

    http.HandleFunc("/item/{item_id}", handler)
    testserver := httptest.NewServer(http.HandlerFunc(handler))
    defer testserver.Close()

    req, err := http.NewRequest("PUT", testserver.URL, nil)
    if err != nil {}

    var client http.Client
    client.Do(req)
}
</code></pre>

コマンド

<p>$ go test ./... -v</p>

実行結果

<pre><code>=== RUN   TestHandler
itemID:  
--- PASS: TestHandler (0.00s)
</code></pre>

<p>例えば、この実行結果の部分で<code>itemID</code>を出力させたいです。</p>
<!-- {% endraw %} -->
