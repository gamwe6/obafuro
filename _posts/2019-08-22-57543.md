---
layout: post
title: スクリプト実行時に401エラーが発生するようになりました
date: 2019-08-22 10:31:08
categories: google-apps-script
---
<!-- {% raw %} -->
<p>業務ツールとして使用しているスプレッドシートのスクリプトを実行したところ、<br>
添付画像1枚目のようなポップアップが表示されるようになり、<br>
「続行」をクリックすると添付画像2枚目のような401エラー画面が表示され、<br>
スクリプトが実行不可になりました。数日前までは問題なく実行できていました。</p>

<p><a href="https://i.stack.imgur.com/4Y6gq.jpg" rel="nofollow noreferrer"><img src="https://i.stack.imgur.com/4Y6gq.jpg" alt="1枚目の画像"></a><br>
<a href="https://i.stack.imgur.com/zaNi2.jpg" rel="nofollow noreferrer"><img src="https://i.stack.imgur.com/zaNi2.jpg" alt="2枚目の画像"></a></p>

<p>該当のスクリプトを記述しているスプレッドシートのコピーを作成し、<br>
改めてスクリプトを実行したところ、問題なく実行することができました。</p>

<p>インターネット検索で調べてみたのですが、類似の現象を見つけることができませんでした。<br>
該当のスクリプトにはCloud Platformプロジェクトが含まれているのですが、<br>
エラーが発生したものはスクリプトのリソースメニューに<br>
「Cloud Platformプロジェクト...」の項目がなく、<br>
スプレッドシートをコピーしたものについては項目が存在していました。</p>

<p>推測ですがCloud Platformプロジェクトに有効期限のようなものがあり、<br>
期限が切れてしまったためにスクリプトが実行不可となったのではないかと思っています。<br>
スプレッドシートのコピーを作成するだけで有効期限切れが無効になるのはおかしな話ですが。。<br>
　※Cloud Platformには無料枠というものがあるらしく、<br>
　　そちらは12か月の使用期限があるようなのですが、<br>
　　該当のスクリプトが無料枠を利用して作成されたものかはわかりません。</p>

<p>エラーの再発防止のため、エラー原因と根本的な対処方法についてご教示いただければ幸いです。</p>
<!-- {% endraw %} -->
