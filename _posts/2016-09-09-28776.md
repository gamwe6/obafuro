---
layout: post
title: Windowsがロック画面の状態で、デスクトップアプリにSendMessageを送りたい
date: 2016-09-09 04:59:19
categories: c# windows win32api
---
<!-- {% raw %} -->
<p>Windowsのロック画面中に、USB接続のリモコン操作をトリガーに、<br>
デスクトップアプリの該当のボタンに「マウスクリック」のSendMessageを送信したい<br>
と考えています。</p>

<pre><code>※マウスクリック時の処理を直接呼出しが出来れば簡単ですが、
  外部アプリケーションでAPIがないため、
  マウス操作をプログラムで実施して、処理を呼び出す方法を考えています。
</code></pre>

<p>下記に、マウスクリック部のソースを抜粋しますが、<br>
ロック画面でなければ実現できているため、<br>
ロック画面中だと、デスクトップにマウス操作は通知できないのかと思います。</p>

<p>実現方法をご存じの方はいないでしょうか。</p>

<p>---- ソース抜粋 開始 ----- </p>

<p>～ USBリモコンのボタンイベントのハンドル部 ～</p>

<p>//マウス左クリックダウン<br>
SendMessage(クリック対象のボタンハンドル, WM_LBUTTONDOWN, MK_LBUTTON, 0x000A000A);<br>
//マウス左クリックアップ <br>
SendMessage(クリック対象のボタンハンドル, WM_LBUTTONUP, 0x00000000, 0x000A000A);</p>

<p>～ USBリモコンのボタンイベントのハンドル部 ～</p>

<p>----- ソース抜粋 終了 ----- </p>
<!-- {% endraw %} -->
