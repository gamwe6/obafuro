---
layout: post
title: "DBスキーマの変更で発生するソースコードとDBスキーマの不整合をデプロイ時にどうやって解決するか？"
date: 2014-12-08 03:28:47
categories: ruby ruby-on-rails デプロイ
---
<p>ロードバランサで複数のWEBサーバに処理を分散していて、WEBサーバは一つのDBサーバを参照しているrailsアプリがあります。</p>

<p>運用している中で、テーブルのカラムを削除する必要がある場合、マイグレーションファイルでremove_columnをすると思うのですが、
capistranoで全てのWEBサーバにデプロイする中で、デプロイ対象のWEBサーバが多いとWEBサーバでは削除したカラムを参照しますが、
DB側はrake db:migrateが実行されたためにカラムが削除されているという状況が発生するような気がしています。</p>

<p>このような事象が発生しないように複数サーバへのデプロイを行うにはどうすればよいでしょうか？</p>
