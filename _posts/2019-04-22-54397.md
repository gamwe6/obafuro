---
layout: post
title: 同じ番号を持つグループの中でステータスが混在している場合だけ値を更新するSQL文を作成したい
date: 2019-04-22 10:57:21
categories: sql
---
<p>1個のテーブル(A_TBL)の中で、「A番号」、「B番号」、「C番号」が共に同じレコードが存在することがあり、それらの中で「ステータス1」が”0”と”1”が混在している場合があります。</p>

<p>その条件に合致する全てのレコードに対して、「ステータス1」を”2"、「ステータス2」を”0”にするSQL文を作りたいのですが、上手くいきません。</p>

<p>どなたかご教示をお願いできますでしょうか。</p>

<p>(例）「A_TBL」<br>
項目名：   　A番号  ,  B番号,    C番号 ,   ステータス1 ,   ステータス2</p>

<hr>

```
      "A001"  "B001"   "C01"        0            1
      "A001"  "B001"   "C01"        0            1
      "A001"  "B001"   "C01"        0            1
```

<hr>

```
      "A002"  "B001"   "C01"        1            1
      "A002"  "B001"   "C01"        1            1
```

<hr>

```
      "A003"  "B002"   "C01"        1            1
      "A003"  "B002"   "C01"        1            1
      "A003"  "B002"   "C01"        0            1
```

<hr>

```
      "A004"  "B002"   "C02"        1            1
      "A004"  "B002"   "C02"        1            1
      "A004"  "B002"   "C02"        1            1
```

<hr>

```
      "A005"  "B002"   "C01"        1            1
      "A005"  "B002"   "C01"        0            1
      "A005"  "B002"   "C01"        1            1
```

<hr>

<p>（（例）の表記に誤りがあり、修正しました。sayuri様、指摘ありがとうございました。）</p>

<p>上記の内、「A003/B002/C01」と「A005/B002/C01」の組合せグループが変更対象となります。<br>
この3レコードに対して、ステータス1を"2"に、ステータス2を"0"に変更したいのですが。。</p>

<p>RDBMSは「SQL Server 2016」です。<br>
どうぞよろしくお願いいたします。</p>
