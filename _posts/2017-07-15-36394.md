---
layout: post
title: "PCをスリープさせると、 vagrant からホスト名の解決ができなくなる"
date: 2017-07-15 15:59:19
categories: vagrant virtualbox
---
<h2>環境構成</h2>

<p>ノートPC</p>

<p>ホスト: Windows 10<br>
ゲスト: Ubuntu<br>
仮想マシン: VirtualBox + Vagrant</p>

<h2>起きていること</h2>

<p>ノートパソコンの上で、 VirtualBox + Vagrant で ubuntu を構成しています。ノートPCなので、移動のタイミングなどで電源をつけっぱなしにしてノートPCを閉じて、移動するということをよく行います。</p>

<p>これを行っていくと、気づいたら、問題なく動いていた仮想マシンから、ホスト名の解決ができなくなっている場合があります。具体的には:</p>

<pre><code>curl www.google.com        # =&gt; unknown host 
curl ホストで調べたIP直指定  # =&gt; 正しく取得できる
</code></pre>

<p>グーグルに限らず、あらゆるホスト名の解決ができなくなります。一方で、ホスト側では問題なくホスト名でもって WEB の閲覧や nslookup が実行できています。</p>

<hr>

<p>これが起きた時の対処方法は分かっていて、 <code>vagrant reload</code> でもって仮想マシンを再起動すれば治るのですが、疑問に思っているのが、どうして、これがそもそも発生しているのだろうか、また、もうちょっと楽な直し方はないのか、ということです。(コンテナ内で完結すれば、楽です。)</p>

<h2>質問</h2>

<p>一体どうして、仮想マシンのみで、ホスト名が解決できなくなっているのでしょうか。再起動以外で治す方法はありますでしょうか。</p>
