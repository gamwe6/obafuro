---
layout: post
title: PHP クッキーの保存を確約したい
date: 2015-12-22 07:48:22
categories: php
---
<!-- {% raw %} -->
<p>フォーム入力時に、</p>

<p><strong>1. フォーム情報をクッキーへ保存する<br>
 2. 外部サイトへリダイレクト</strong></p>

<p>を１回のリクエストで行いたい。</p>

<hr>

<p>Paypalを利用したカート機能を実装していまして、購入者情報を入力しsubmitした際に、<br>
購入者情報の保存とPaypalへのリダイレクトを行う処理になります。<br>
セッションは仕様により、クッキーを使用することとなっています。</p>

<p>この処理を実装した所、<br>
リダイレクトはされるものの、クッキーが保存されていませんでした。</p>

<p><strong>ブラウザへクッキーの送信が完了していないままリダイレクトされてしまっているためと判断しました</strong>。</p>

<p>が、仕様は変えずに済む回避方法など有りましたら教えていただきたいと思います。</p>

<p><a href="http://php.net/manual/ja/function.setcookie.php" rel="nofollow">http://php.net/manual/ja/function.setcookie.php</a></p>

<blockquote>
  <p>この関数では、ユーザーがクッキーを受け入れたかどうかを判断することはできません。</p>
</blockquote>

<hr>

<p>購入者入力ページの前のページ（カート内確認ページ）にて商品を確認している（クッキーを受け入れてる）ので、ユーザのクッキー受け入れ許可自体はあまり気にしなくてよいとは考えています。（この考えはおかしいでしょうか？）</p>
<!-- {% endraw %} -->
